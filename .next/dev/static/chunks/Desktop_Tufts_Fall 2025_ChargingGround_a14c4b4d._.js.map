{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/brendan.roy/Desktop/Tufts/Fall%202025/ChargingGround/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nexport const supabase = createClient(\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n);\n"],"names":[],"mappings":";;;;AAGE;AAHF;;AAEO,MAAM,WAAW,IAAA,8PAAY","debugId":null}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///Users/brendan.roy/Desktop/Tufts/Fall%202025/ChargingGround/app/admin/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { supabase } from \"@/lib/supabase\";\nimport { useRouter } from \"next/navigation\";\n\nexport default function AdminPage() {\n  const router = useRouter();\n  const [user, setUser] = useState(null);\n  const [orders, setOrders] = useState([]);\n\n  // Load user\n  useEffect(() => {\n    supabase.auth.getUser().then(({ data }) => {\n      if (!data.user) router.push(\"/admin/login\");\n      else setUser(data.user);\n    });\n  }, []);\n\n  // Load orders continuously\n  useEffect(() => {\n    if (!user) return;\n\n    const fetchOrders = async () => {\n      const { data, error } = await supabase\n        .from(\"orders\")\n        .select(\"*\")\n        .order(\"created_at\", { ascending: false });\n\n      if (!error && data) {\n        setOrders((prev) => {\n          // Insert new ones but keep removed ones gone\n          const previousIds = prev.map((o) => o.id);\n          const newOnes = data.filter((o) => !previousIds.includes(o.id));\n\n          // Keep only orders that aren't picked up\n          const filtered = data.filter((o) => o.status !== \"picked-up\");\n\n          return filtered;\n        });\n      }\n    };\n\n    fetchOrders();\n    const interval = setInterval(fetchOrders, 4000);\n    return () => clearInterval(interval);\n  }, [user]);\n\n  // --- THIS ONE GUARANTEES REMOVAL ---\n  async function updateStatus(id: string, status: string) {\n    await supabase\n      .from(\"orders\")\n      .update({ status })\n      .eq(\"id\", id);\n\n    if (status === \"picked-up\") {\n      setOrders((prev) => prev.filter((o) => o.id !== id)); // <- removes instantly\n    } else {\n      setOrders((prev) =>\n        prev.map((o) => (o.id === id ? { ...o, status } : o))\n      );\n    }\n  }\n\n  if (!orders) return null;\n\n  return (\n    <div className=\"container-page py-10\">\n      <h1 className=\"text-3xl font-bold mb-6\">All Orders</h1>\n\n      {orders.length === 0 ? (\n        <p>No current orders.</p>\n      ) : (\n        orders.map((order) => (\n          <div\n            key={order.id}\n            className=\"p-4 border rounded mb-4 bg-white shadow\"\n          >\n            <div className=\"flex justify-between\">\n              <div>\n                <p><strong>Name:</strong> {order.name}</p>\n                <p><strong>Status:</strong> {order.status}</p>\n              </div>\n\n              <select\n                className=\"border p-1 rounded\"\n                value={order.status}\n                onChange={(e) => updateStatus(order.id, e.target.value)}\n              >\n                <option value=\"pending\">Pending</option>\n                <option value=\"preparing\">Preparing</option>\n                <option value=\"ready\">Ready</option>\n                <option value=\"picked-up\">Picked Up</option>\n              </select>\n            </div>\n\n            <div className=\"mt-2 text-sm\">\n              <p><strong>Items:</strong></p>\n              <ul className=\"list-disc ml-5\">\n                {order.items?.map((i, idx) => (\n                <li key={idx}>{i.item?.name} x{i.qty}</li>\n                ))}\n                </ul>\n\n            </div>\n          </div>\n        ))\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}